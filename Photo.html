<!DOCTYPE html>
<!-- saved from url=(0114)https://script.google.com/macros/s/AKfycbz99xbAry2XNv0PbJwAGYVDWlNvKG5mAPueVEJtt6e2fiuFSM4a6cfi1eZptsTgI1FK8g/exec -->
<html><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/content/location/location.js" id="eppiocemhmnlbhjplcgkofciiegomcon"></script><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/libs/extend-native-history-api.js"></script><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/libs/requests.js"></script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="chromevox" content-script="no">
<title>Site Visit Planner</title>
<link rel="stylesheet" href="./Photo_files/icon" nonce=""><link rel="stylesheet" href="./Photo_files/2107809627-mae_html_css_ltr.css">
<script type="text/javascript" src="./Photo_files/475811768-warden_bin_i18n_warden__en_gb.js.download" nonce=""></script><script bis_use="true" type="text/javascript" charset="utf-8" data-bis-config="[&quot;facebook.com/&quot;,&quot;twitter.com/&quot;,&quot;youtube-nocookie.com/embed/&quot;,&quot;//vk.com/&quot;,&quot;//www.vk.com/&quot;,&quot;linkedin.com/&quot;,&quot;//www.linkedin.com/&quot;,&quot;//instagram.com/&quot;,&quot;//www.instagram.com/&quot;,&quot;//www.google.com/recaptcha/api2/&quot;,&quot;//hangouts.google.com/webchat/&quot;,&quot;//www.google.com/calendar/&quot;,&quot;//www.google.com/maps/embed&quot;,&quot;spotify.com/&quot;,&quot;soundcloud.com/&quot;,&quot;//player.vimeo.com/&quot;,&quot;//disqus.com/&quot;,&quot;//tgwidget.com/&quot;,&quot;//js.driftt.com/&quot;,&quot;friends2follow.com&quot;,&quot;/widget&quot;,&quot;login&quot;,&quot;//video.bigmir.net/&quot;,&quot;blogger.com&quot;,&quot;//smartlock.google.com/&quot;,&quot;//keep.google.com/&quot;,&quot;/web.tolstoycomments.com/&quot;,&quot;moz-extension://&quot;,&quot;chrome-extension://&quot;,&quot;/auth/&quot;,&quot;//analytics.google.com/&quot;,&quot;adclarity.com&quot;,&quot;paddle.com/checkout&quot;,&quot;hcaptcha.com&quot;,&quot;recaptcha.net&quot;,&quot;2captcha.com&quot;,&quot;accounts.google.com&quot;,&quot;www.google.com/shopping/customerreviews&quot;,&quot;buy.tinypass.com&quot;,&quot;gstatic.com&quot;,&quot;secureir.ebaystatic.com&quot;,&quot;docs.google.com&quot;,&quot;contacts.google.com&quot;,&quot;github.com&quot;,&quot;mail.google.com&quot;,&quot;chat.google.com&quot;,&quot;audio.xpleer.com&quot;,&quot;keepa.com&quot;,&quot;static.xx.fbcdn.net&quot;,&quot;sas.selleramp.com&quot;,&quot;1plus1.video&quot;,&quot;console.googletagservices.com&quot;,&quot;//lnkd.demdex.net/&quot;,&quot;//radar.cedexis.com/&quot;,&quot;//li.protechts.net/&quot;,&quot;challenges.cloudflare.com/&quot;,&quot;ogs.google.com&quot;]" src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/executors/traffic.js"></script>
</head>
<body bis_register="W3sibWFzdGVyIjp0cnVlLCJleHRlbnNpb25JZCI6ImVwcGlvY2VtaG1ubGJoanBsY2drb2ZjaWllZ29tY29uIiwiYWRibG9ja2VyU3RhdHVzIjp7IkRJU1BMQVkiOiJkaXNhYmxlZCIsIkZBQ0VCT09LIjoiZGlzYWJsZWQiLCJUV0lUVEVSIjoiZGlzYWJsZWQiLCJSRURESVQiOiJkaXNhYmxlZCIsIlBJTlRFUkVTVCI6ImRpc2FibGVkIiwiSU5TVEFHUkFNIjoiZGlzYWJsZWQiLCJUSUtUT0siOiJkaXNhYmxlZCIsIkxJTktFRElOIjoiZGlzYWJsZWQiLCJDT05GSUciOiJkaXNhYmxlZCJ9LCJ2ZXJzaW9uIjoiMi4wLjMzIiwic2NvcmUiOjIwMDMzfV0=" __processed_c32164db-c164-4c0f-a324-36b9fbafc3cd__="true">
<table id="warning-bar-table" class="full_size" cellspacing="0" cellpadding="0"><tbody><tr><td><div id="warning" class="warning-bar warning-banner-bar" bis_skin_checked="1" role="banner" aria-live="assertive" aria-labelledby="warning-text"><div class="warning-banner" bis_skin_checked="1"><div class="warning-banner-header" bis_skin_checked="1"><span class="warning-banner-icon"><svg aria-hidden="true" viewbox="0 0 24 24" width="24px" height="24px"><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></svg></span><div class="warning-banner-text" id="warning-text" role="alert" bis_skin_checked="1">This application was created by a Google Apps Script user</div></div><div class="warning-banner-buttons" bis_skin_checked="1"><a class="warning-link" href="https://developers.google.com/apps-script" target="_blank">Learn more</a></div></div><div class="warning-banner-close-icon" tabindex="0" role="button" aria-label="Dismiss" bis_skin_checked="1"><svg aria-hidden="true" viewbox="0 0 24 24" width="24px" height="24px"><path d="M6.4 19 5 17.6l5.6-5.6L5 6.4 6.4 5l5.6 5.6L17.6 5 19 6.4 13.4 12l5.6 5.6-1.4 1.4-5.6-5.6Z"></path></svg></div></div></td></tr><tr><td style="height: 100%"><iframe id="sandboxFrame" title="Site Visit Planner" allow="accelerometer *; ambient-light-sensor *; autoplay *; camera *; clipboard-read *; clipboard-write *; encrypted-media *; fullscreen *; geolocation *; gyroscope *; magnetometer *; microphone *; midi *; payment *; picture-in-picture *; screen-wake-lock *; speaker *; sync-xhr *; usb *; web-share *; vibrate *; vr *" sandbox="allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation allow-storage-access-by-user-activation" src="./Photo_files/userCodeAppPanel.html" bis_size="{&quot;x&quot;:0,&quot;y&quot;:45,&quot;w&quot;:1920,&quot;h&quot;:874,&quot;abs_x&quot;:0,&quot;abs_y&quot;:45}" bis_id="fr_292865k64hyq471w8lnj2f" bis_depth="0" bis_chainid="1">
</iframe>
</td></tr></tbody></table><script nonce="">
(function() {
var el = document.getElementById('sandboxFrame');
el.onload = function() {
goog.script.init("\x7b\x22functionNames\x22:\x5b\x22onOpen\x22,\x22refreshToVisit\x22,\x22getDriveInfo\x22,\x22durationTextToMinutes\x22,\x22extractClusterFromAddress\x22,\x22buildMapsUrl\x22,\x22getVisitData\x22,\x22doGet\x22\x5d,\x22sandboxMode\x22:\x22IFRAME_SANDBOX\x22,\x22callbackTimeout\x22:390000,\x22deploymentId\x22:\x22AKfycbz99xbAry2XNv0PbJwAGYVDWlNvKG5mAPueVEJtt6e2fiuFSM4a6cfi1eZptsTgI1FK8g\x22,\x22eei\x22:\x22\x22,\x22sandboxHost\x22:\x22https:\/\/n-tunmflw67c76tje4y7quf74agifzeeeg2y6ev7a-0lu-script.googleusercontent.com\x22,\x22clientSideProperties\x22:\x7b\x22google.script.sandbox.mode\x22:\x22IFRAME_SANDBOX\x22,\x22google.script.host.origin\x22:\x22https:\/\/docs.google.com\x22\x7d,\x22actionPrefix\x22:\x22\/macros\/s\/AKfycbz99xbAry2XNv0PbJwAGYVDWlNvKG5mAPueVEJtt6e2fiuFSM4a6cfi1eZptsTgI1FK8g\x22,\x22userHtml\x22:\x22\x3c!DOCTYPE html\x3e\\n\x3chtml\x3e\\n  \x3chead\x3e\\n    \x3cbase target\x3d\\\x22_top\\\x22\x3e\\n    \x3cmeta name\x3d\\\x22viewport\\\x22 content\x3d\\\x22width\x3ddevice-width, initial-scale\x3d1\\\x22\x3e\\n    \x3cstyle\x3e\\n      :root \x7b\\n        --bg-gradient-start: #5b5de6;\\n        --bg-gradient-end: #3b2c82;\\n        --card-bg: #ffffff;\\n        --card-soft: rgba(255, 255, 255, 0.1);\\n        --text-primary: #1f2341;\\n        --text-muted: #7b82a1;\\n        --accent-1: #ff6b6b;\\n        --accent-2: #3bc9db;\\n        --accent-3: #51cf66;\\n        --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.25);\\n        --radius-xl: 24px;\\n      \x7d\\n\\n      * \x7b\\n        box-sizing: border-box;\\n        font-family: system-ui, -apple-system, BlinkMacSystemFont, \\\x22Segoe UI\\\x22,\\n          sans-serif;\\n      \x7d\\n\\n      body \x7b\\n        margin: 0;\\n        padding: 24px;\\n        background: radial-gradient(circle at top, #f5f7ff 0, #d9defa 40%, #141432 100%);\\n        min-height: 100vh;\\n        display: flex;\\n        justify-content: center;\\n        align-items: flex-start;\\n      \x7d\\n\\n      .app-shell \x7b\\n        width: 100%;\\n        max-width: 1200px;\\n        background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));\\n        border-radius: 32px;\\n        padding: 20px;\\n        box-shadow: var(--shadow-soft);\\n        color: white;\\n      \x7d\\n\\n      .inner \x7b\\n        background: rgba(255, 255, 255, 0.94);\\n        border-radius: 24px;\\n        padding: 24px;\\n      \x7d\\n\\n      .header \x7b\\n        display: flex;\\n        flex-direction: column;\\n        gap: 8px;\\n        margin-bottom: 18px;\\n      \x7d\\n\\n      .title-row \x7b\\n        display: flex;\\n        justify-content: space-between;\\n        align-items: center;\\n        gap: 12px;\\n        flex-wrap: wrap;\\n      \x7d\\n\\n      .title-text \x7b\\n        font-size: 1.6rem;\\n        font-weight: 700;\\n        color: var(--text-primary);\\n      \x7d\\n\\n      .header-right \x7b\\n        display: flex;\\n        gap: 8px;\\n        align-items: center;\\n        flex-wrap: wrap;\\n        justify-content: flex-end;\\n      \x7d\\n\\n      .office-label \x7b\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 8px;\\n        padding: 8px 14px;\\n        border-radius: 999px;\\n        background: rgba(91, 93, 230, 0.08);\\n        color: var(--text-muted);\\n        font-size: 0.85rem;\\n      \x7d\\n\\n      .office-label span.key \x7b\\n        font-size: 1.1rem;\\n      \x7d\\n\\n      .all-map-btn \x7b\\n        border: none;\\n        outline: none;\\n        padding: 8px 14px;\\n        border-radius: 999px;\\n        font-size: 0.85rem;\\n        background: #2563eb;\\n        color: white;\\n        cursor: pointer;\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 6px;\\n        box-shadow: 0 8px 18px rgba(37, 99, 235, 0.4);\\n        white-space: nowrap;\\n      \x7d\\n\\n      .all-map-btn span.icon \x7b\\n        font-size: 1rem;\\n      \x7d\\n\\n      .all-map-btn:disabled \x7b\\n        opacity: 0.5;\\n        cursor: default;\\n        box-shadow: none;\\n      \x7d\\n\\n      .all-map-btn:not(:disabled):hover \x7b\\n        background: #1d4ed8;\\n      \x7d\\n\\n      .summary-row \x7b\\n        display: grid;\\n        grid-template-columns: repeat(3, minmax(0, 1fr));\\n        gap: 12px;\\n        margin-bottom: 18px;\\n      \x7d\\n\\n      .summary-card \x7b\\n        background: linear-gradient(135deg, #ffffff, #f1f3ff);\\n        border-radius: 18px;\\n        padding: 14px 16px;\\n        display: flex;\\n        flex-direction: column;\\n        gap: 4px;\\n      \x7d\\n\\n      .summary-label \x7b\\n        font-size: 0.8rem;\\n        text-transform: uppercase;\\n        letter-spacing: 0.06em;\\n        color: var(--text-muted);\\n      \x7d\\n\\n      .summary-value \x7b\\n        font-size: 1.4rem;\\n        font-weight: 700;\\n        color: var(--text-primary);\\n      \x7d\\n\\n      .layout \x7b\\n        display: grid;\\n        grid-template-columns: minmax(0, 0.55fr) minmax(0, 0.45fr);\\n        gap: 16px;\\n        align-items: stretch;\\n      \x7d\\n\\n      .clusters-panel \x7b\\n        background: linear-gradient(145deg, #f7f8ff, #ecf0ff);\\n        border-radius: var(--radius-xl);\\n        padding: 16px 14px;\\n        overflow-y: auto;\\n        max-height: 520px;\\n      \x7d\\n\\n      .map-panel \x7b\\n        background: radial-gradient(circle at 0 0, #ffffff 0, #eef2ff 40%, #d7e3ff 100%);\\n        border-radius: var(--radius-xl);\\n        padding: 16px;\\n        display: flex;\\n        flex-direction: column;\\n        gap: 10px;\\n      \x7d\\n\\n      .map-header \x7b\\n        display: flex;\\n        justify-content: space-between;\\n        align-items: center;\\n        font-size: 0.85rem;\\n        color: var(--text-muted);\\n      \x7d\\n\\n      .chip \x7b\\n        padding: 6px 10px;\\n        border-radius: 999px;\\n        background: rgba(91, 93, 230, 0.08);\\n      \x7d\\n\\n      .legend \x7b\\n        display: flex;\\n        gap: 8px;\\n        font-size: 0.78rem;\\n        color: var(--text-muted);\\n      \x7d\\n\\n      .legend-item \x7b\\n        display: flex;\\n        align-items: center;\\n        gap: 4px;\\n      \x7d\\n\\n      .dot \x7b\\n        width: 8px;\\n        height: 8px;\\n        border-radius: 999px;\\n      \x7d\\n\\n      .dot.c1 \x7b background: var(--accent-1); \x7d\\n      .dot.c2 \x7b background: var(--accent-2); \x7d\\n      .dot.c3 \x7b background: var(--accent-3); \x7d\\n\\n      .office-node \x7b\\n        align-self: center;\\n        background: white;\\n        border-radius: 999px;\\n        padding: 8px 14px;\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 8px;\\n        box-shadow: 0 12px 28px rgba(15, 23, 42, 0.18);\\n        margin-top: 10px;\\n      \x7d\\n\\n      .office-avatar \x7b\\n        width: 28px;\\n        height: 28px;\\n        border-radius: 999px;\\n        background: linear-gradient(135deg, #4c6fff, #a855f7);\\n        display: flex;\\n        align-items: center;\\n        justify-content: center;\\n        color: #fff;\\n        font-size: 0.95rem;\\n        font-weight: 700;\\n      \x7d\\n\\n      .office-text \x7b\\n        font-size: 0.8rem;\\n        color: var(--text-primary);\\n      \x7d\\n\\n      .office-text span \x7b\\n        font-weight: 600;\\n      \x7d\\n\\n      .ray-container \x7b\\n        position: relative;\\n        flex: 1;\\n        margin-top: 22px;\\n        border-radius: 18px;\\n        background: linear-gradient(145deg, #ffffff, #e4edff);\\n        box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.2);\\n        overflow: hidden;\\n      \x7d\\n\\n      .ray \x7b\\n        position: absolute;\\n        width: 1px;\\n        background: linear-gradient(to bottom, rgba(79, 70, 229, 0.75), rgba(79, 70, 229, 0));\\n        transform-origin: top center;\\n      \x7d\\n\\n      .ray-dot \x7b\\n        position: absolute;\\n        bottom: -6px;\\n        left: -6px;\\n        width: 12px;\\n        height: 12px;\\n        border-radius: 999px;\\n        border: 2px solid white;\\n      \x7d\\n\\n      .ray-dot.c1 \x7b background: var(--accent-1); \x7d\\n      .ray-dot.c2 \x7b background: var(--accent-2); \x7d\\n      .ray-dot.c3 \x7b background: var(--accent-3); \x7d\\n      .ray-dot.cX \x7b background: #9ca3af; \x7d\\n\\n      .clusters-list \x7b\\n        display: flex;\\n        flex-direction: column;\\n        gap: 12px;\\n      \x7d\\n\\n      .cluster-card \x7b\\n        background: white;\\n        border-radius: 18px;\\n        padding: 12px 12px 10px;\\n        box-shadow: 0 8px 22px rgba(15, 23, 42, 0.06);\\n        border: 1px solid rgba(148, 163, 184, 0.22);\\n      \x7d\\n\\n      .cluster-header \x7b\\n        display: flex;\\n        align-items: center;\\n        justify-content: space-between;\\n        margin-bottom: 8px;\\n        gap: 8px;\\n      \x7d\\n\\n      .cluster-pill \x7b\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 6px;\\n      \x7d\\n\\n      .cluster-index \x7b\\n        width: 22px;\\n        height: 22px;\\n        border-radius: 999px;\\n        display: flex;\\n        align-items: center;\\n        justify-content: center;\\n        font-size: 0.78rem;\\n        font-weight: 700;\\n        color: white;\\n      \x7d\\n\\n      .cluster-title \x7b\\n        font-size: 0.9rem;\\n        font-weight: 600;\\n        color: var(--text-primary);\\n      \x7d\\n\\n      .cluster-meta \x7b\\n        font-size: 0.75rem;\\n        color: var(--text-muted);\\n      \x7d\\n\\n      .site-card \x7b\\n        background: linear-gradient(135deg, #ffffff, #f7f9ff);\\n        border-radius: 14px;\\n        padding: 8px 10px;\\n        margin-bottom: 6px;\\n        border: 1px solid rgba(148, 163, 184, 0.18);\\n      \x7d\\n\\n      .site-address \x7b\\n        font-size: 0.83rem;\\n        color: var(--text-primary);\\n        margin-bottom: 2px;\\n      \x7d\\n\\n      .site-extra \x7b\\n        font-size: 0.76rem;\\n        color: var(--text-muted);\\n        display: flex;\\n        justify-content: space-between;\\n      \x7d\\n\\n      .site-badges \x7b\\n        display: flex;\\n        gap: 4px;\\n      \x7d\\n\\n      .badge \x7b\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 4px;\\n        font-size: 0.74rem;\\n        padding: 3px 6px;\\n        border-radius: 999px;\\n        background: rgba(148, 163, 184, 0.12);\\n      \x7d\\n\\n      .metrics \x7b\\n        display: inline-flex;\\n        gap: 6px;\\n        align-items: center;\\n      \x7d\\n\\n      .metric-pill \x7b\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 4px;\\n        font-size: 0.75rem;\\n        padding: 3px 6px;\\n        border-radius: 999px;\\n        background: rgba(79, 70, 229, 0.06);\\n        color: #4338ca;\\n      \x7d\\n\\n      .metric-pill span.icon \x7b\\n        font-size: 0.9rem;\\n      \x7d\\n\\n      .open-map-btn \x7b\\n        border: none;\\n        outline: none;\\n        padding: 4px 9px;\\n        border-radius: 999px;\\n        font-size: 0.75rem;\\n        background: #2563eb;\\n        color: white;\\n        cursor: pointer;\\n        display: inline-flex;\\n        align-items: center;\\n        gap: 4px;\\n      \x7d\\n\\n      .open-map-btn:hover \x7b\\n        background: #1d4ed8;\\n      \x7d\\n\\n      .footer-note \x7b\\n        margin-top: 10px;\\n        font-size: 0.75rem;\\n        color: var(--text-muted);\\n        text-align: right;\\n      \x7d\\n\\n      .empty-state \x7b\\n        text-align: center;\\n        color: var(--text-muted);\\n        font-size: 0.9rem;\\n        padding: 40px 10px;\\n      \x7d\\n\\n      @media (max-width: 900px) \x7b\\n        body \x7b\\n          padding: 12px;\\n        \x7d\\n\\n        .app-shell \x7b\\n          padding: 14px;\\n        \x7d\\n\\n        .layout \x7b\\n          grid-template-columns: minmax(0, 1fr);\\n        \x7d\\n\\n        .clusters-panel \x7b\\n          max-height: none;\\n        \x7d\\n\\n        .header-right \x7b\\n          justify-content: flex-start;\\n        \x7d\\n      \x7d\\n    \x3c\\\/style\x3e\\n  \x3c\\\/head\x3e\\n  \x3cbody\x3e\\n    \x3cdiv class\x3d\\\x22app-shell\\\x22\x3e\\n      \x3cdiv class\x3d\\\x22inner\\\x22\x3e\\n        \x3cdiv class\x3d\\\x22header\\\x22\x3e\\n          \x3cdiv class\x3d\\\x22title-row\\\x22\x3e\\n            \x3cdiv class\x3d\\\x22title-text\\\x22\x3eSite Visit Planner\x3c\\\/div\x3e\\n            \x3cdiv class\x3d\\\x22header-right\\\x22\x3e\\n              \x3cbutton class\x3d\\\x22all-map-btn\\\x22 id\x3d\\\x22all-map-btn\\\x22 disabled\x3e\\n                \x3cspan class\x3d\\\x22icon\\\x22\x3eüó∫Ô∏è\x3c\\\/span\x3e\\n                \x3cspan\x3eView all in Google Maps\x3c\\\/span\x3e\\n              \x3c\\\/button\x3e\\n              \x3cdiv class\x3d\\\x22office-label\\\x22\x3e\\n                \x3cspan class\x3d\\\x22key\\\x22\x3eüìç\x3c\\\/span\x3e\\n                \x3cspan id\x3d\\\x22office-address\\\x22\x3e\x3c\\\/span\x3e\\n              \x3c\\\/div\x3e\\n            \x3c\\\/div\x3e\\n          \x3c\\\/div\x3e\\n        \x3c\\\/div\x3e\\n\\n        \x3cdiv class\x3d\\\x22summary-row\\\x22\x3e\\n          \x3cdiv class\x3d\\\x22summary-card\\\x22\x3e\\n            \x3cdiv class\x3d\\\x22summary-label\\\x22\x3eTotal Sites\x3c\\\/div\x3e\\n            \x3cdiv class\x3d\\\x22summary-value\\\x22 id\x3d\\\x22total-sites\\\x22\x3e\\u2013\x3c\\\/div\x3e\\n          \x3c\\\/div\x3e\\n          \x3cdiv class\x3d\\\x22summary-card\\\x22\x3e\\n            \x3cdiv class\x3d\\\x22summary-label\\\x22\x3eClusters\x3c\\\/div\x3e\\n            \x3cdiv class\x3d\\\x22summary-value\\\x22 id\x3d\\\x22total-clusters\\\x22\x3e\\u2013\x3c\\\/div\x3e\\n          \x3c\\\/div\x3e\\n          \x3cdiv class\x3d\\\x22summary-card\\\x22\x3e\\n            \x3cdiv class\x3d\\\x22summary-label\\\x22\x3eEst. Drive Time\x3c\\\/div\x3e\\n            \x3cdiv class\x3d\\\x22summary-value\\\x22 id\x3d\\\x22total-time\\\x22\x3e\\u2013\x3c\\\/div\x3e\\n          \x3c\\\/div\x3e\\n        \x3c\\\/div\x3e\\n\\n        \x3cdiv class\x3d\\\x22layout\\\x22\x3e\\n          \x3cdiv class\x3d\\\x22clusters-panel\\\x22\x3e\\n            \x3cdiv id\x3d\\\x22clusters-list\\\x22 class\x3d\\\x22clusters-list\\\x22\x3e\\n              \x3cdiv class\x3d\\\x22empty-state\\\x22\x3eLoading visit data\\u2026\x3c\\\/div\x3e\\n            \x3c\\\/div\x3e\\n          \x3c\\\/div\x3e\\n\\n          \x3cdiv class\x3d\\\x22map-panel\\\x22\x3e\\n            \x3cdiv class\x3d\\\x22map-header\\\x22\x3e\\n              \x3cdiv class\x3d\\\x22chip\\\x22\x3eLondon area ¬∑ visual drive rays (not exact map)\x3c\\\/div\x3e\\n              \x3cdiv class\x3d\\\x22legend\\\x22\x3e\\n                \x3cdiv class\x3d\\\x22legend-item\\\x22\x3e\\n                  \x3cspan class\x3d\\\x22dot c1\\\x22\x3e\x3c\\\/span\x3e\x3cspan\x3eCluster 1\x3c\\\/span\x3e\\n                \x3c\\\/div\x3e\\n                \x3cdiv class\x3d\\\x22legend-item\\\x22\x3e\\n                  \x3cspan class\x3d\\\x22dot c2\\\x22\x3e\x3c\\\/span\x3e\x3cspan\x3eCluster 2\x3c\\\/span\x3e\\n                \x3c\\\/div\x3e\\n                \x3cdiv class\x3d\\\x22legend-item\\\x22\x3e\\n                  \x3cspan class\x3d\\\x22dot c3\\\x22\x3e\x3c\\\/span\x3e\x3cspan\x3eCluster 3\x3c\\\/span\x3e\\n                \x3c\\\/div\x3e\\n              \x3c\\\/div\x3e\\n            \x3c\\\/div\x3e\\n\\n            \x3cdiv class\x3d\\\x22office-node\\\x22\x3e\\n              \x3cdiv class\x3d\\\x22office-avatar\\\x22\x3eüè¢\x3c\\\/div\x3e\\n              \x3cdiv class\x3d\\\x22office-text\\\x22\x3e\\n                \x3cdiv\x3eOffice start\x3c\\\/div\x3e\\n                \x3cspan id\x3d\\\x22office-address-small\\\x22\x3e\x3c\\\/span\x3e\\n              \x3c\\\/div\x3e\\n            \x3c\\\/div\x3e\\n\\n            \x3cdiv class\x3d\\\x22ray-container\\\x22 id\x3d\\\x22ray-container\\\x22\x3e\x3c\\\/div\x3e\\n\\n            \x3cdiv class\x3d\\\x22footer-note\\\x22\x3e\\n              Sites are ordered by drive time from the office (closest first).\\n              Click \\\x22View all in Google Maps\\\x22 to see all visit sites on one map,\\n              or \\\x22Open route\\\x22 on any site card for a single route.\\n            \x3c\\\/div\x3e\\n          \x3c\\\/div\x3e\\n        \x3c\\\/div\x3e\\n      \x3c\\\/div\x3e\\n    \x3c\\\/div\x3e\\n\\n    \x3cscript\x3e\\n      function formatTotalTime(minutes) \x7b\\n        if (!minutes || minutes \x3c\x3d 0) return \x27\\u2013\x27;\\n        const hrs \x3d Math.floor(minutes \/ 60);\\n        const mins \x3d Math.round(minutes % 60);\\n        if (hrs \x3d\x3d\x3d 0) return mins + \x27 mins\x27;\\n        if (mins \x3d\x3d\x3d 0) return hrs + \x27h\x27;\\n        return hrs + \x27h \x27 + mins + \x27m\x27;\\n      \x7d\\n\\n      function clusterColorClass(index) \x7b\\n        const n \x3d (index % 3) + 1;\\n        return \x27c\x27 + n;\\n      \x7d\\n\\n      \\n      function buildMultiRouteUrl(office, rows) \x7b\\n        if (!office || !rows || !rows.length) return null;\\n        const encode \x3d encodeURIComponent;\\n        const addresses \x3d rows\\n          .map(r \x3d\x3e (r.site || \x27\x27).trim())\\n          .filter(Boolean);\\n\\n        if (!addresses.length) return null;\\n\\n        \\n        const destination \x3d addresses\x5baddresses.length - 1\x5d;\\n        const waypointsArr \x3d addresses.slice(0, -1);\\n        let url \x3d\\n          \x27https:\/\/www.google.com\/maps\/dir\/?api\x3d1\x27 +\\n          \x27\x26origin\x3d\x27 + encode(office) +\\n          \x27\x26destination\x3d\x27 + encode(destination) +\\n          \x27\x26travelmode\x3ddriving\x27;\\n\\n        if (waypointsArr.length) \x7b\\n          const waypoints \x3d waypointsArr.join(\x27|\x27);\\n          url +\x3d \x27\x26waypoints\x3d\x27 + encode(waypoints);\\n        \x7d\\n        return url;\\n      \x7d\\n\\n      function renderPlanner(payload) \x7b\\n        const originalRows \x3d payload.rows || \x5b\x5d;\\n        const office \x3d payload.office || \x27\x27;\\n\\n        \\n        const rows \x3d originalRows.slice().sort((a, b) \x3d\x3e \x7b\\n          const am \x3d parseFloat(a.durationMinutes) || 0;\\n          const bm \x3d parseFloat(b.durationMinutes) || 0;\\n          return am - bm;\\n        \x7d);\\n\\n        document.getElementById(\x27office-address\x27).textContent \x3d office;\\n        document.getElementById(\x27office-address-small\x27).textContent \x3d office;\\n\\n        const allMapBtn \x3d document.getElementById(\x27all-map-btn\x27);\\n\\n        if (!rows.length) \x7b\\n          document.getElementById(\x27clusters-list\x27).innerHTML \x3d\\n            \x27\x3cdiv class\x3d\\\x22empty-state\\\x22\x3eNo sites with Status \x3d \\\x22Visit\\\x22 found.\x3c\\\/div\x3e\x27;\\n          document.getElementById(\x27total-sites\x27).textContent \x3d \x270\x27;\\n          document.getElementById(\x27total-clusters\x27).textContent \x3d \x270\x27;\\n          document.getElementById(\x27total-time\x27).textContent \x3d \x27\\u2013\x27;\\n          if (allMapBtn) \x7b\\n            allMapBtn.disabled \x3d true;\\n            allMapBtn.onclick \x3d null;\\n          \x7d\\n          return;\\n        \x7d\\n\\n        \\n        if (allMapBtn) \x7b\\n          const multiUrl \x3d buildMultiRouteUrl(office, rows);\\n          if (multiUrl) \x7b\\n            allMapBtn.disabled \x3d false;\\n            allMapBtn.onclick \x3d function () \x7b\\n              window.open(multiUrl, \x27_blank\x27);\\n            \x7d;\\n          \x7d else \x7b\\n            allMapBtn.disabled \x3d true;\\n            allMapBtn.onclick \x3d null;\\n          \x7d\\n        \x7d\\n\\n        \\n        const clustersMap \x3d \x7b\x7d;\\n        rows.forEach(r \x3d\x3e \x7b\\n          const key \x3d r.cluster || \x27Other\x27;\\n          if (!clustersMap\x5bkey\x5d) clustersMap\x5bkey\x5d \x3d \x5b\x5d;\\n          clustersMap\x5bkey\x5d.push(r);\\n        \x7d);\\n\\n        \\n        const clusterKeys \x3d Object.keys(clustersMap).sort((a, b) \x3d\x3e \x7b\\n          const aMin \x3d clustersMap\x5ba\x5d.reduce((min, r) \x3d\x3e \x7b\\n            const v \x3d parseFloat(r.durationMinutes) || 0;\\n            return v \x3c min ? v : min;\\n          \x7d, Number.POSITIVE_INFINITY);\\n          const bMin \x3d clustersMap\x5bb\x5d.reduce((min, r) \x3d\x3e \x7b\\n            const v \x3d parseFloat(r.durationMinutes) || 0;\\n            return v \x3c min ? v : min;\\n          \x7d, Number.POSITIVE_INFINITY);\\n          return aMin - bMin;\\n        \x7d);\\n\\n        const totalSites \x3d rows.length;\\n        const totalClusters \x3d clusterKeys.length;\\n        const totalMinutes \x3d rows.reduce((sum, r) \x3d\x3e \x7b\\n          const v \x3d parseFloat(r.durationMinutes);\\n          return sum + (isNaN(v) ? 0 : v);\\n        \x7d, 0);\\n\\n        document.getElementById(\x27total-sites\x27).textContent \x3d totalSites;\\n        document.getElementById(\x27total-clusters\x27).textContent \x3d totalClusters;\\n        document.getElementById(\x27total-time\x27).textContent \x3d\\n          formatTotalTime(totalMinutes);\\n\\n        \\n        const listEl \x3d document.getElementById(\x27clusters-list\x27);\\n        listEl.innerHTML \x3d \x27\x27;\\n\\n        clusterKeys.forEach((clusterKey, idx) \x3d\x3e \x7b\\n          const sites \x3d clustersMap\x5bclusterKey\x5d.slice().sort((a, b) \x3d\x3e \x7b\\n            const am \x3d parseFloat(a.durationMinutes) || 0;\\n            const bm \x3d parseFloat(b.durationMinutes) || 0;\\n            return am - bm;\\n          \x7d);\\n\\n          const clusterCard \x3d document.createElement(\x27div\x27);\\n          clusterCard.className \x3d \x27cluster-card\x27;\\n\\n          const colorClass \x3d clusterColorClass(idx);\\n\\n          const header \x3d document.createElement(\x27div\x27);\\n          header.className \x3d \x27cluster-header\x27;\\n\\n          const left \x3d document.createElement(\x27div\x27);\\n          left.className \x3d \x27cluster-pill\x27;\\n\\n          const indexBubble \x3d document.createElement(\x27div\x27);\\n          indexBubble.className \x3d \x27cluster-index \x27 + colorClass;\\n          indexBubble.textContent \x3d idx + 1;\\n\\n          const title \x3d document.createElement(\x27div\x27);\\n          title.className \x3d \x27cluster-title\x27;\\n          title.textContent \x3d clusterKey;\\n\\n          left.appendChild(indexBubble);\\n          left.appendChild(title);\\n\\n          const rightMeta \x3d document.createElement(\x27div\x27);\\n          rightMeta.className \x3d \x27cluster-meta\x27;\\n          rightMeta.textContent \x3d\\n            sites.length + \x27 site\x27 + (sites.length \x3e 1 ? \x27s\x27 : \x27\x27);\\n\\n          header.appendChild(left);\\n          header.appendChild(rightMeta);\\n          clusterCard.appendChild(header);\\n\\n          sites.forEach(site \x3d\x3e \x7b\\n            const siteEl \x3d document.createElement(\x27div\x27);\\n            siteEl.className \x3d \x27site-card\x27;\\n\\n            const addr \x3d document.createElement(\x27div\x27);\\n            addr.className \x3d \x27site-address\x27;\\n            addr.textContent \x3d site.site || \x27\x27;\\n            siteEl.appendChild(addr);\\n\\n            const extraRow \x3d document.createElement(\x27div\x27);\\n            extraRow.className \x3d \x27site-extra\x27;\\n\\n            const badges \x3d document.createElement(\x27div\x27);\\n            badges.className \x3d \x27site-badges\x27;\\n\\n            if (site.dealNo) \x7b\\n              const dealBadge \x3d document.createElement(\x27div\x27);\\n              dealBadge.className \x3d \x27badge\x27;\\n              dealBadge.textContent \x3d \x27Deal \x27 + site.dealNo;\\n              badges.appendChild(dealBadge);\\n            \x7d\\n\\n            extraRow.appendChild(badges);\\n\\n            const metrics \x3d document.createElement(\x27div\x27);\\n            metrics.className \x3d \x27metrics\x27;\\n\\n            if (site.durationText) \x7b\\n              const time \x3d document.createElement(\x27div\x27);\\n              time.className \x3d \x27metric-pill\x27;\\n              time.innerHTML \x3d\\n                \x27\x3cspan class\x3d\\\x22icon\\\x22\x3e‚è±\x3c\\\/span\x3e\x27 + site.durationText;\\n              metrics.appendChild(time);\\n            \x7d\\n\\n            if (site.distance) \x7b\\n              const dist \x3d document.createElement(\x27div\x27);\\n              dist.className \x3d \x27metric-pill\x27;\\n              dist.innerHTML \x3d\\n                \x27\x3cspan class\x3d\\\x22icon\\\x22\x3eüìè\x3c\\\/span\x3e\x27 + site.distance;\\n              metrics.appendChild(dist);\\n            \x7d\\n\\n            extraRow.appendChild(metrics);\\n            siteEl.appendChild(extraRow);\\n\\n            const buttonRow \x3d document.createElement(\x27div\x27);\\n            buttonRow.style.marginTop \x3d \x276px\x27;\\n            buttonRow.style.display \x3d \x27flex\x27;\\n            buttonRow.style.justifyContent \x3d \x27flex-end\x27;\\n\\n            if (site.url) \x7b\\n              const btn \x3d document.createElement(\x27button\x27);\\n              btn.className \x3d \x27open-map-btn\x27;\\n              btn.innerHTML \x3d \x27Open route \x3cspan\x3e‚Üó\x3c\\\/span\x3e\x27;\\n              btn.onclick \x3d function () \x7b\\n                window.open(site.url, \x27_blank\x27);\\n              \x7d;\\n              buttonRow.appendChild(btn);\\n            \x7d\\n\\n            siteEl.appendChild(buttonRow);\\n            clusterCard.appendChild(siteEl);\\n          \x7d);\\n\\n          listEl.appendChild(clusterCard);\\n        \x7d);\\n\\n        \\n        const rayContainer \x3d document.getElementById(\x27ray-container\x27);\\n        rayContainer.innerHTML \x3d \x27\x27;\\n        const maxMinutes \x3d\\n          rows.reduce((m, r) \x3d\x3e \x7b\\n            const v \x3d parseFloat(r.durationMinutes);\\n            return v \x3e m ? v : m;\\n          \x7d, 0) || 1;\\n\\n        rows.forEach((site, idx) \x3d\x3e \x7b\\n          const ray \x3d document.createElement(\x27div\x27);\\n          ray.className \x3d \x27ray\x27;\\n\\n          const normalized \x3d (parseFloat(site.durationMinutes) || 10) \/ maxMinutes;\\n          const rayLength \x3d 120 + normalized * 120;\\n\\n          ray.style.height \x3d rayLength + \x27px\x27;\\n\\n          const angle \x3d -40 + (80 * idx) \/ Math.max(rows.length - 1, 1);\\n          ray.style.transform \x3d \x27rotate(\x27 + angle + \x27deg)\x27;\\n          ray.style.left \x3d \x2750%\x27;\\n          ray.style.top \x3d \x2715%\x27;\\n\\n          const dot \x3d document.createElement(\x27div\x27);\\n          const clusterIndex \x3d clusterKeys.indexOf(site.cluster || clusterKeys\x5b0\x5d);\\n          dot.className \x3d\\n            \x27ray-dot \x27 +\\n            (clusterIndex \x3e\x3d 0 ? clusterColorClass(clusterIndex) : \x27cX\x27);\\n          ray.appendChild(dot);\\n\\n          rayContainer.appendChild(ray);\\n        \x7d);\\n      \x7d\\n\\n      \\n      google.script.run.withSuccessHandler(renderPlanner).getVisitData();\\n    \x3c\\\/script\x3e\\n  \x3c\\\/body\x3e\\n\x3c\\\/html\x3e\\n\x22,\x22ncc\x22:\x22\x7b\\\x22awhs\\\x22:true\x7d\x22\x7d", "AJuLMu2ovY93UZFpHVCyTCVdaAExWnDbTg:1763375304523", undefined, true , true  , "true", "https:\/\/n-tunmflw67c76tje4y7quf74agifzeeeg2y6ev7a-0lu-script.googleusercontent.com", "");}
el.src = 'https:\/\/n-tunmflw67c76tje4y7quf74agifzeeeg2y6ev7a-0lu-script.googleusercontent.com\/userCodeAppPanel?createOAuthDialog\x3dtrue';
}());
</script>


</body></html>